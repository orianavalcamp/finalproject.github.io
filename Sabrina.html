<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Oriana Valcamp Final Project</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ballet:opsz@16..72&family=League+Script&display=swap');
        @media (min-width: 1025px) {
            body {
                background-image: url('sabrina_laptop.png');
                background-repeat: no-repeat;
                background-size: cover;
                background-color: #38b6ff;
            }
        }
        @media (min-width: 701px) and (max-width: 1024px) and (orientation: portrait){
            body {
                background-image: url('sabrina_ipad_vertical.png');
                background-repeat: no-repeat;
                background-size: cover;
                background-color: #38b6ff;
            }
        }
        @media (min-width: 701px) and (max-width: 1024px) and (orientation: landscape){
            body {
                background-image: url('sabrina_ipad_horizontal.png');
                background-repeat: no-repeat;
                background-size: cover;
                background-color: #38b6ff;
            }
        }
        @media (min-width: 641px) and (max width: 700px){
            body {
                background-image: url('sabrina_tablet.png');
                background-repeat: no-repeat;
                background-size: cover;
                background-color: #38b6ff;
            }
        }
        @media (max-width: 640px){
            body {
                background-image: url('sabrina_phone.png');
                background-repeat: no-repeat;
                background-size: cover;
                background-color: #38b6ff;
            }
        }

    	.container {
        	display: flex;
        	flex-wrap: wrap;
        	justify-content: center;
    	}

    	.item {
       	 	width: 100%;
       	 	max-width: 400px;
        	margin: 20px;
        	text-align: center;
    	}

    	img{
    		cursor: pointer;
    	}

        .button{
            font-family: league script;
            background color: white;
            width: 10%;
            color: red;
            cursor: pointer;
        }

        #myInput {
            box-sizing: border-box;
            background-image: url('searchicon.png');
            background-position: 14px 12px;
            background-repeat: no-repeat;
            font-size: 20pt;
            font-family: league script;
            padding: 14px 20px 12px 45px;
            border: none;
        }

        #myInput:focus {outline: 3px solid #ddd;}

        .dropdown {
            float: left;
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            right: 100px;
            background-color: white;
            min-width: 150px;
            overflow: auto;
        }

        .dropdown:hover .dropdown-content {
            display: block;
        }

        .dropdown-content a {
            color: red;
            padding: 12px 16px;
            font-size: 15pt;
            text-decoration: none;
            font-family: league script;
            display: block;
        }

        .dropdown a:hover {background-color: lightgrey}

        .show {display: block;}

        .audio-container {
            text-align: center;
            width: 50%;
            position: absolute;
            left: 25%;
            top: 10px;
        }

        .progress-container {
            height: 4px;
            background-color: rgba(255, 255, 255, 0.5);
            margin: 10px;
            position: relative;
            cursor: pointer;
        }

        .progress-bar {
            height: 100%;
            background-color: red;
            width: 0;
            transition: width 0.1s;
        }

        .audio-container .progress-container:hover .progress-bar {
            background-color: red;
        }

        /* The Popup - hidden by default */
        .popup {
            display: none; /* Hide popup by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5); /* Semi-transparent background */
            justify-content: center;
            align-items: center;
            z-index: 9999; /* Ensure the popup is above all other content */
        }

        /* Popup Content */
        .popup-content {
            background-color: rgba(255, 255, 255, 0.5);
            padding: 20px;
            border-radius: 8px;
            max-width: 400px;
            width: 80%;
            text-align: left;
            font-family: league script;
            accent-color: red;
        }

        /* Close Button */
        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 24px;
            cursor: pointer;
            color: #000;
        }
	</style>
</head>
<body>
    <a href = "FinalProject.html">
        <button class="button" style="font-size: 15pt;">Back to Main Gallery</button>
    </a>
    <div class="dropdown" style="position: absolute; top: 10px; right: 10px;">
        <button>
            <img style="width: 100px; position: absolute; top: 0px; right: 0px;" src="record.gif">
        </button>
      <div class="dropdown-content">
        <a href="#" class="audioMenuItem" data-audio="Taste.mp3">Taste</a>
        <a href="#" class="audioMenuItem" data-audio="Please Please Please.mp3">Please Please Please</a>
        <a href="#" class="audioMenuItem" data-audio="Good Graces.mp3">Good Graces</a>
        <a href="#" class="audioMenuItem" data-audio="Sharpest Tool.mp3">Sharpest Tool</a>
        <a href="#" class="audioMenuItem" data-audio="Coincidence.mp3">Coincidence</a>
        <a href="#" class="audioMenuItem" data-audio="Bed Chem.mp3">Bed Chem</a>
        <a href="#" class="audioMenuItem" data-audio="Espresso.mp3">Espresso</a>
        <a href="#" class="audioMenuItem" data-audio="Dumb & Poetic.mp3">Dumb & Poetic</a>
        <a href="#" class="audioMenuItem" data-audio="Slim Pickins.mp3">Slim Pickins</a>
        <a href="#" class="audioMenuItem" data-audio="Juno.mp3">Juno</a>
        <a href="#" class="audioMenuItem" data-audio="Lie To Girls.mp3">Lie To Girls</a>
        <a href="#" class="audioMenuItem" data-audio="Dont Smile.mp3">Don't Smile</a>
      </div>
    </div>

    <div class="audio-container" id="audioPlayerContainer" style="display: none; position: center;">
        <audio id="audio" preload="auto"></audio>

        <button class= "button" id="playPauseButton">Play</button>

        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>

    </div>
        <button id="showPopupBtn">
            <img style="width: 75px; position: absolute; bottom: 0px; left: 10px;" src="mixer.png">
        </button>

    <div id="popup" class="popup">
        <div class="popup-content">
            <label for="volume">Volume: </label>
            <input id="volume" type="range" min="0" max="1" step="0.01" value="1">
            <br>
            <label for="pan">Pan</label>
            <input id="pan" type="range" min="-1" max="1" step="0.1" value="0">
            <br>
            <label for="frequencySlider">Cutoff Frequency: <span id="frequencyValue">1000</span> Hz</label>
            <input id="frequencySlider" type="range" min="100" max="20000" value="1000" step="10">
            <br>
            <button class = "button" id="enableFilter" style="width: auto;">Enable Low-Pass Filter</button>
            <button class = "button" id="enableHighPassFilter" style="width: auto;">Enable High-Pass Filter</button>
        </div>
    </div>
    
    <script>
        const audio = document.getElementById("audio");
        const playPauseButton = document.getElementById("playPauseButton");
        const progressBar = document.getElementById("progressBar");
        const progressContainer = document.querySelector(".progress-container");
        const audioPlayerContainer = document.getElementById("audioPlayerContainer");
        const audioMenuItems = document.querySelectorAll(".audioMenuItem");
        const popup = document.getElementById("popup");
        const showPopupBtn = document.getElementById("showPopupBtn");
        const volumeSlider = document.getElementById('volume');
        const panSlider = document.getElementById('pan');
        const slider = document.getElementById('frequencySlider');
        const frequencyValue = document.getElementById('frequencyValue');
        const enableFilterButton = document.getElementById('enableFilter');

        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        let isPlaying = false; // Ensure the initial state is false
        let biquadFilter, isFilterEnabled = false;
        let biquadFilterLowPass = null;  
        let biquadFilterHighPass = null;

        const audioSource = audioContext.createMediaElementSource(audio);
        const panNode = audioContext.createStereoPanner();
        audioSource.connect(panNode);
        panNode.connect(audioContext.destination);

        audio.volume = volumeSlider.value;

        // Function to resume the AudioContext (required for modern browsers)
        function resumeAudioContext() {
            if (audioContext.state === 'suspended') {
                audioContext.resume().then(() => {
                    console.log("AudioContext resumed.");
                }).catch(error => {
                    console.error("Error resuming AudioContext:", error);
                });
            }
        }

        // Show the audio player when the menu item is clicked
        audioMenuItems.forEach(item => {
            item.addEventListener("click", (e) => {
                e.preventDefault(); // Prevent the default anchor behavior
                resumeAudioContext(); // Ensure AudioContext is resumed

                const audioSrc = item.getAttribute("data-audio");

                // Update audio source and play
                audio.src = audioSrc;
                audio.load(); // Load the new audio source
                audio.play().then(() => {
                    playPauseButton.textContent = "Pause";
                    isPlaying = true;

                    // Show the audio player container
                    audioPlayerContainer.style.display = "block";
                }).catch(error => {
                    console.error("Playback failed:", error);
                });
            });
        });

        // Play/Pause functionality
        playPauseButton.addEventListener("click", () => {
            resumeAudioContext(); // Resume AudioContext if necessary

            if (isPlaying) {
                audio.pause();
                playPauseButton.textContent = "Play";
            } else {
                audio.play().then(() => {
                    playPauseButton.textContent = "Pause";
                    isPlaying = true;
                }).catch(error => {
                    console.error("Playback failed:", error);
                });
            }
            isPlaying = !isPlaying;
        });

        // Update the progress bar as the audio plays
        audio.addEventListener("timeupdate", () => {
            const progress = (audio.currentTime / audio.duration) * 100;
            progressBar.style.width = `${progress}%`;
        });

        // Click event to seek audio position
        progressContainer.addEventListener("click", (e) => {
            const progressWidth = progressContainer.offsetWidth;
            const clickPosition = e.offsetX;
            const seekTime = (clickPosition / progressWidth) * audio.duration;
            audio.currentTime = seekTime;
        });

        // When the button is clicked, show the popup
        showPopupBtn.addEventListener("click", () => {
            popup.style.display = "flex"; // Show the popup by changing the display style
        });

        // Optional: Close the popup if the user clicks outside of the popup content
        window.addEventListener("click", (event) => {
            if (event.target === popup) {
                popup.style.display = "none"; // Hide the popup if clicked outside
            }
        });

        // Update the audio volume
        volumeSlider.addEventListener('input', (event) => {
            audio.volume = parseFloat(event.target.value); // Correctly update the volume
        });

        // Pan functionality
        panSlider.addEventListener('input', (event) => {
            panNode.pan.value = event.target.value;
        });

        // Add Low-Pass and High-Pass Filters (No Changes Needed Here)
        // ... (Keep your original low-pass and high-pass filter code)
    </script>

</body>
</html>
